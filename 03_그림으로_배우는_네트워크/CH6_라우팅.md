# 라우팅

---

## 6-1 라우팅

- 이더넷과 무선LAN으로 **같은 네트워크** 안에서 데이터를 전송할 수 있음
- **다른 네트워크**에 데이터를 보내려면 네트워크를 서로 연결하는 라우터로 전송해야 함
- **라우팅** = 라우터는 데이터의 목적지가 어느 네트워크에 접속해 있는지 판단해서 연결된 네트워크의 라우터로 전송
- 라우팅을 계속 반복해서 목적지까지 보낼 수 있음
- 라우터가 전송할 대상이 되는 데이터는 **IP 패킷**(TCP/IP 인터넷층에서 동작)
- IP 패킷전송할 때 목적지 IP 주소를 확인하고 IP 헤더의 **TTL**과 **헤더 체크섬**만 변경됨
- 나머지 부분은 변경되지 않은 채로 전송(NAT 변환이 이루어질 때 IP 주소도 변경)
- But, 이데넷 헤더 등 네트워크 인터페이스층의 프로토콜 헤더는 라우터가 전송할 때 완전히 새로운 헤더로 변경됨
- ![프레임과 패킷의 구조](https://t1.daumcdn.net/cfile/tistory/1360E30F4AAF6DB710)

---

## 6-2 네트워크의 연결

- 라우터로 네트워크를 연결할 때도 IP주소를 설정
- 라우터 인터페이스의 물리적 배선에 더해 IP주소를 설정
- 라우터에는 복수의 인터페이스가 준비되어 있어 물리적인 배선과 IP 주소 설정을 각각 할 필요가 있음.
- ![라우터와 연결된 모습](https://lh3.googleusercontent.com/proxy/5LrrT1ciE_SCCyZYdo0ZAEdEmWbZxoStM0y8MNjmklT7L1l-ciIWQTR16MEii7_fRqWLGzDcZzWED3qCNMfppnntXHbXqWU)

---

## 6-3 데이터의 전송처 결정

- 라우터가 데이터를 전송하는 흐름
  - 라우팅 대상인 IP 패킷을 수신함
    - 목적저 MAC주소와 IP주소의 정보를 가진 패킷
  - 경로 정보를 검색해서 전송할 것을 결정
    - 라우팅 테이블에서 경로정보를 검색하여 넥스트 홉(다음에 전송할 라우터)를 알아내서 전송

## 6-4 다음 라우터로 데이터 전송

- 레이어2 헤더를 수정해 IP 패킷을 전송
- 다른 라우터(R1 -> R2)로 전송할 때 이더넷 헤더를 추가해야 함
  - R2의 MAC주소를 구하기 위해 ARP를 실행
    - ARP는 IP주소로 MAC주소를 구하는 프로토콜
    - 라우팅 테이블에서 R2의 IP주소를 아므로 R2의 MAC주소를 구하기위해 ARP를 실행

## 6-5 다음 라우터의 처리

- R2에서도 같은 처리를 함
  - 호스트1이 송신한 패킷과 비교하면 MAC 주소는 바뀌었지만, IP 주소는 같습니다.

## 6-6 최종 목적지 데이터 전송

- 라우팅 테이블에 같은 네트워크에 있는걸 확인
- 최종목적지인 호스트2로 IP 패킷을 전송하려면 호스트2의 MAC 주소가 필요함 - ARP를 사용해서 구함
- 데이터가 도착하면 응답받아 같은 절차로 돌아옴

---

## 6-7 라우팅 테이블

- 라우팅 테이블에는 어떤 네트워크로 IP 패킷을 전송하기 위한 경로가 등록되어 있음
  - 경로는 다음에 전송해야 하는 라우터
  - 테이블에 등록된 네트워크 정보를 루트정보나 경로정보라고 부름
- 경로 정보의 내용
  - Cisco System 라우터의 라우팅 테이블의 예
