# 이더넷과 무선 LAN

---

## 5-1 이더넷과 무선 LAN(Wi-fi)
- 네트워크는 **라우터** 또는 **레이어3 스위치**로 구획되는 범위
- 기본적인 구성은 네트워크 구성은 레이어2 스위치로 하나의 네트워크를 구성하고 라우터 또는 레이어3 스위치로 각 네트워크를 서로 연결
- PC에서 서버로 가는 데이터는 우선 PC와 같은 네트워크 상에 있는 라우터로 전송
- 라우터에 도착하면 같은 네트워크에 있는 목적지 라우터까지 전송하고 라우터에서 목적 서버로 전송
- 같은 네트워크내에서 전송하는 프로토콜은 주로 **이더넷**과 **무선 LAN(Wi-fi)**
- 네트워크 인터페이스 층

---

## 5-2 이더넷의 개요
- 이더넷은 네트워크 인터페이스 층의 프로토콜
- 이더넷은 같은 네트워크 내의 이더넷 인터페이스 사이에서 데이터를 전송하기 위한 프로토콜
- 같은 레이어2 스위치에 연결된 PC는 같은 네트워크(VLAN 사용하면 다른네트워크를 사용할 수 있음)
- 레이어2 스위치는 데이터에 변형을 가하지 않고 그대로 보냄

--- 

## 5-3 IEEE802 위원회
- 이더넷 규격은 IEEE802 위원회에서 결정
- 규격은 최대 전송속도와 이용하는 케이블에 따라 나뉨
- ex) 1000BASE-T
  - 맨 앞 숫자는 전송속도를 나타냄  mbps
  - BASE는 베이스 밴드 방식 베이스 밴드말고는 없음
  - -는 물리 신호 변환의 특징 T가 있으면 UTP 케이블 이용(LAN) 
  - ![이더넷 규격](https://i2.wp.com/mindmazenetworks.com/wp-content/uploads/2019/02/image.png?resize=930%2C450&ssl=1&crop=1)

---

## 5-4 MAC 주소
- 이더넷 인터페이스를 특정하기 위해 **MAC 주소**가 있음
- 48비트 주소
  - 24비트는 OUI(인터페이스 제조하는 벤더 식별 코드) / 24비트는 시리얼넘버(각 벤더가 할당)
- 이더넷 인터페이스에 미리 할당 되어 있어 변경할 수 없음
- 물리주소나 하드웨어 주소라고도 부름
- MAC주소는 16진수로 표기
  - 1바이트씩 16진수 '-'로 구분 00-00-01-02-03-04
  - 1바이트씩 16진수 ':'로 구분 00:00:01:02:03:04
  - 2바이트씩 16진수 '.'로 구분 0000.0102.0304

---

## 5-5 RJ-45 인터페이스와 UTP 케이블
- 자주 사용하는 이더넷 규격
  - 10BASE-T, 100BASE-t, 100BASE-T, 10GBASE-T
  - 이 규격들은 모두 **RJ-45 인터페이스**와 **UTP 케이블을 채용**하고 있음
- UTP 케이블
  - 흔히 말하는 LAN 케이블
  - 8중의 절연체로 감싼 구리선을 2줄씩 꼬아서 4쌍으로 만든 케이블
  - 카테고리아 따라서 지원할 수 있는 주파수가 달라지고 용도나 전송속도가 정해짐
  - ![UTP 케이블](https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Ethernet_RJ45_connector_p1160054.jpg/640px-Ethernet_RJ45_connector_p1160054.jpg)
- RJ-45 인터페이스 
  - UTP 케이블용 인터넷 인터페이스
  - ![RJ-45](https://sc04.alicdn.com/kf/HTB1gcaYSFXXXXaqaXXXq6xXFXXXJ.jpg)

---

## 5-6 이더넷의 프레임 형식
- 이더넷으로 데이터를 전송하기 위해서는 **이더넷 헤더**가 필요함, 이 때 **FCS**도 붙임
- FCS는 에러 체크
- 이더넷 헤더 + 데이터 + FCS = **이더넷 프레임**
- 이더넷 헤더
  - MAC 주소 3가지
    - 목적지
    - 출발지
    - 타입 코드
- TCP/IP를 사용할 경우 IPv4를 나타내는 0x8000이 지정되어 있음
  - ![이더넷 타입 코드](https://elearning.vector.com/pluginfile.php/266/mod_page/content/8/IP_4.3_GRA_ExampleTypeField_EN.png)
- 데이터는 64바이트에서 1500바이트 사이로 정해져 있음
- 데이터 크기의 최대값을 MTU(Maximum Transmission Unit)로 설정하고 MTU보다 클 경우 복수로 분할해서 전송
- 이더넷 프레임의 최대 크기는 64~1518바이트
- ![이더넷 프레임](https://t1.daumcdn.net/cfile/tistory/1258B1484F90FC671C)

---

## 5-7 토폴리지
- 토폴로지(topology)는 도형의 연결 방식이나 위칙 관계에 초점을 둔 학문 분야로서, 네트워크에서도 기기를 연결하는 형태를 나타내는 말로도 이용
- 접속 형태는 세가지
  - ![세가지 모형](https://3mym.files.wordpress.com/2013/11/topologies.gif)
  - 버스형
    - 버스형 토폴리지를 초기에 많이 사용하였고 하나의 전송 매체를 복수의 기기가 공유하는 형태
    - 이 때 전송매체를 어떻게 공유할 것인지 제어해야 함. 제어할 때는 CSMA/CD방식을 사용
  - 스타형
    - 레이어 스위치를 중심으로 함
  - 링형

---

## 5-8 CSMA/CD
- 어떤 순간에 데이터를 전송할 수 있는 것은 한 대뿐
- Carrier Sense Multiple Access with Collision Detector
  - ![흐름도](https://t1.daumcdn.net/cfile/tistory/2307003355ED42F136)
  - 먼저 가는 쪽이 승리하는 방식
  - CS는 현재 케이블이 사용중인지 감지
  - 같이 전송해 버리면 충돌이 일어남
  - 충돌이 발생하면 재전송 하는데 랜덤의 대기시간을 가지고 전송
- 하지만 현재 이더넷은 전송매체를 공유하는 것이 아니기 때문에 CSMA/CD가 필요 없음

---

## 5-9 레이어2 스위치
- ![레이어 2스위치 모형](https://www.onvcom.com/Uploads/202004/5e8cacd29a691.jpg)
- 이더넷을 이용한 네트워크 하나를 구성하는 네트워크 기기
- 여러대 연결해도 하나의 네트워크
- 이더넷 프레임을 데이터 변경없이 전송만 하고 MAC주소를 확인하는 역할만 함
- 네트워크의 입구 역할도 함
  - 엑세스 스위치, 스위칭 허브라고도 부름

---

## 5-10 레이어2 스위치의 데이터 전송
- ![총 과정](http://blog.skby.net/blog/wp-content/uploads/2018/12/1-21.png)
- 데이터 전송
  - 수신한 이더넷 프레임의 출발지 MAC 주소를 MAC 주소 테이블에 등록
  - 목적지 MAC주소와 MAC 주소 테이블에서 전송할 포트를 결정해 이더넷 프레임을 전송
  - 테이블에 없는 MAC 주소이면 수신 포트를 제외한 모든 포트에 이더넷 프레임을 전송 = 플러딩
  - 설정은 필요 없음

## 5-11 UnKnown 유니캐스트 프레임, 플러딩
- MAC 주소 테이블에 등록되지 않은 MAC 주소가 목적지로 되어 있는 이더넷 프레임을 **Unknown유니캐스트 프레임**
- UnKnown 유니캐스트 프레임은 수신한 포트를 제외한 모든 포트에 전송 = 프레임
- 모르면 일단 전송한다는 무책임한 방식, 같은 네트워크여서 악영향이 크지 않음

## 5-12 이더넷 프레임 전송 후 MAC 주소 테이블에 등록
- 복수의 레이어2 스위치가 있어도 각각의  레이어2 스위치는 같은 방식으로 동작
- 출발지를 계속 기억하면서 같은 네트워크내의 이더넷 인터페이스로 전송

## 5-13 이더넷 프레임 수신 후 MAC 주소 테이블에 등록
- 통신은 양방향임
- 응답이 돌아갈 때도 마찬가지로 전송할 때와 똑같이 전송
- 반환된 이더넷 프레임은 원래 프레임의 목적지와 출발지 MAC주소가 교체된 주소가 됨

---

## 5-14 MAC 주소 테이블
- 하나의 포트에 하나의 MAC주소는 아님 => 하나의 포트에 여러 MAC 주소가 등록됨
- MAC 주소는 제한시간이 설정 되어있음
  - 스위치 기기에 따라 달라지지만 대략 5분정도

---

## 5-15 전이중 통신
- 데이터 송수신을 동시에 함 = **전이중 통신**
- 반대의 의미로, 반이중 통신은 송신과 수신을 전환하며 처리
- 초기 이더넷은 반이중 통신
- 전이중 통신을 사용하기 위해서는 데이터 수신용과 송신용으로 전송매체를 나누어 사용하는 것
- 현재는 레이어2 스위치를 이용한 이더넷은 나누어져 있음
- UTP 케이블은 8줄로 2줄을 한조씩 하여 송신 수신용으로 나누어 사용

---

## 5-16 무선 LAN
- 이더넷은 유선 네트워크, 케이블 배선 작업은 성가셔서 무선 LAN이 개발됨
- **무선 LAN 액세스 포인트**와 **무선 LAN 인터페이스**가 필요
- 무선 LAN 인터페이스는 노트북이나 스마트폰에 미리 내장되어 있음
- 인터페이스로 무선LAN에 연결된 기기를 가맄 무선 LAN 클라이언트라고도 자주 표현
- 무선 LAN 엑세스 포인트를 경유해 데이터를 주고 받음 = 인프라스트럭처 모드
- 무선 LAN 만으로는 보통 통신이 완결되지 않아 무선 LAN 액세스 포인트는 레이어2 스위치와 접속해 유선 이더넷 네트워크와도 연결됨

---

## 5-17 무선LAN 규격
- 전파의 주파수 대역과 전파에 싣는 방식에 따라 무선 LAN 규격을 나눔
- 크게 2.4Ghz와 5Ghz 대역의 주파수를 이용함
- ex) IEEE802.11n/ac최대 전송속도를 확인해야함
- Wi-fi
  - 무선 LAN 기기의 상호 접속성을 인증한 브랜드
  - 현재는 무선 LAN자체를 가리키는 말로 표현
- ![주요 무선 LAN 규격](http://1.bp.blogspot.com/-hs6Im-bkkvg/UcwuKIG1oKI/AAAAAAAAEQc/wI3RyIFoE_Q/s869/%EC%A3%BC%EC%9A%94+%EC%99%80%EC%9D%B4%ED%8C%8C%EC%9D%B4+%ED%91%9C%EC%A4%80+%EA%B7%9C%EA%B2%A9%EB%B3%84+%ED%99%9C%EC%9A%A9+%EC%A3%BC%ED%8C%8C%EC%88%98+%EB%8C%80%EC%97%AD+%ED%98%84%ED%99%A9.png)

---

## 5-18 어소시에이션
- 무선 LAN에 연결하는 것 = **어소시에이션**
- SSID(Service Set Identifier)를 지정해서 연결
  - 무선 LAN의 논리적인 그룹을 식별하는 식별정보
  - 미리 무선 LAN 액세스 포인트에는 최대 32문자열로 SSID를 지정해둠
- 무선 LAN 클라이언트는 액세스 포인트가 내보내는 제어신호(비콘)에서 이용할 수 있는 전파의 주파수(채널)을 찾음
- 이용할 수 있는 채널을 발견하면 SSID를 지정해서 무선 LAN 액세스 포인트에 어소시에이션 요청을 보냄
- 암호화나 인증 등의 보안설정은 SSID별로 함

---

## 5-19 통신속도
- 무선 LAN은 규격에서 정한 속도대로 통신할 수 있는 경우가 거의 없음
- 실질적인 통신속도를 실효속도나 스루풋이라고 칭함
- 스루풋은 전파를 돌려쓰기 때문에 절반정도라고 생각하면 됨
- 무선 LAN에서 전송매체는 전파로 특정 주파수대의 전파를 **채널**이라고 함
- 어떤 순간에 무선 LAN에서 데이터를 전파에 실어 송신할 수 있는 것은 하나의 무선 LAN 클라이언트 뿐
- 무선 LAN 클라이언트가 전파를 돌러쓰며 데이터를 주고받기 위해서는 **충돌**이 일어나면 안됨
- 충돌을 해결하기 위해 CSMA/CA(Carrier Sense Multiple Access with Collision Avoidance)를 활용

---

## 5-20 CSMA/CA
- 빠른 쪽이 이기는 방식으로 전파를 이용하는 메커니즘
- 1. 전파가 이용중인지 확인 = Carrier Sense 
  - 엑세스 포인트에 어소시에이션했을 때 채널을 알고 있음
  - 전파가 이용중이면 대기, 전파가 검출되지 않았다면 일정 시간 대기
- 2. 랜덤 시간 대기 = Collision Avoidance
  - 바로 송신을 시작하지 않고 랜덤 시간 동안 대기함
  - 복수의 클라이언트가 동시에 전파를 사용할 가능성이 있기 때문
- 3. 데이터 송신
  - 랜덤 시간 대기 후 전파가 미사용이라면 전파에 실어 송신할 수 있음
- 위와 같은 방식으로 제어하므로 무선 LAN 클라이언트는 데이터를 보내려고 할 때 대기시간이 길어져 스루풋이 저하됨
- ![알고리즘](https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Csma_ca.svg/1200px-Csma_ca.svg.png)

---

## 5-21 WPA2
- 무선 LAN은 간편하지만 보안에 취약
- 보안의 핵심은 인증과 암호화
- 일반적인 무선 LAN 보안 규격 WPA2 = IEEE802.11i
- WPA2는 데이터 암호화에 AES, 인증에 IEEE802.1X를 이용