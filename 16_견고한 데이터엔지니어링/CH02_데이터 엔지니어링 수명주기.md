# CH02 데이터 엔지니어링 생명주기

---

## 데이터 생성

- iot, application message queue, rdb 등 원천 데이터
- 데이터 파이프라인에 영향을 줄 수 있는 사항들은 인지하고 있어야 함
- 주요 고려 사항
  - 스키마 불일치 문제
  - 데이터 보관주기
  - 원본데이터 특징
  - 중복이나 데이터 품질
  - 상태성 테이블 문제 어떻게 추적
  - 데이터 품질검사

## 데이터 저장

- 스토리지의 역할 뿐만 아니라 데이터 쿼리와 데이터 수집 변환 서비스에까지 관여되는 단계
- 주요 고려 사항
  - 쓰기 읽기 속도
  - 병목 현상인지
  - 확장성
  - 메타데이터
  - 스키마 타입
  - 데이터 거버넌스와 리니지
  - 법령 준수
- 접근 빈도에 따라 hot, lukewarn, cold 데이터로 나눔

## 데이터 수집

- 원천을 직접 관리할 수 없어 병목현상이 주로 되는 단계
- 주요 고려 사항
  - 데이터의 사용 사례
  - 안정적 수집
  - 목적지
  - 접근빈도
  - 데이터의 포맷과 다운스트림에서 바로 활용할 수 있는지
  - 데이터 변환이 필요한지
- 배치 vs 스트리밍: 데이터 적시성의 기대치에 따라 달라짐
  - 데이터 흐름 속도 처리 가능한지
  - ms단위가 필요한지 분단위가 필요한지
  - 스트리밍 사례가 뭐가 있을지
  - 스트리밍 시스템이 안정적이고 다중화되어 있는가
  - 비용과 트레이드오프
  - ML 모델
  - 원천에 대한 영향
- 푸시 vs 풀

## 데이터 변환

- 다운스트림에서 활용할 수 있도록 적절한 변환을 해야함
- 주요 고려 사항
  - 변환에 드는 투자수익률은 얼마인가, 비즈니스 가치는 무엇인가?
  - 변환은 단순한고 독립적인가?
  - 변환이 지원하는 비즈니스 규칙

## 데이터 서빙

- 데이터의 가치
- 분석 유형
  - BI - adhoc에서 셀프서비스 분석으로 전환 되어야 하는데 여기서 문제는 데이터 품질, 조직 사일로, 데이터 기술 부족등에 문제가 있음
  - 운영 - 실시간 대시보드: 현재에 중점을 둠
  - 임베디드 - 데이터의 개인화를 위해 멀티테넌시를 지원하여 정의된 제어와 필터가 있는 논리뷰를 통해 개별 고객에게 전달됨
  - 머신러닝 - ML엔지니어링 중 데이터 준비, 보관, 처리 같은 측면을 지원해야 함
    - 머신러닝 고려 사항
      - 데이터의 품질
      - 데이터 검색 가능여부
      - 조직적 경계
  - reverse ETL
    - 측정 지표 푸시
    - 광고 플랫폼 데이터 제공

## 드러나지 않는 주요 요소

- 보안
  - 최소 권한 원칙
  - 해당 작업을 수행하는데 필요한 기간 동안만 허용
  - IAM, 역할, 정책, 네트워크, 암호 등의 보안 관련 지식들을 쌓아놀 것
- 데이터 관리
  - 수명 주기 전체에 걸쳐 데이터와 정보 자산의 가치를 제공하고 제어 보호,정책 프로그램과 사례를 개발, 실행 및 감독하는 것
  - 중요한 이유? 데이터가 일상적인 운영에 필수적인 것을 가정함
  - 포함 영역
    - 데이터 거버넌스
      - 데이터의 품질, 무결성, 보안 및 사용성을 보장하기 위한 데이터 관리 기능
      - 핵심 범주
        - 발견 가능성
          - 데이터를 사용할 수 있고 검색할 수 있어야 함
            - 메타 데이터
              - 비즈니스: 데이터가 사용되는 방식으로 정의, 규칙, 로직 등을 포함
              - 기술: 시스템 생성 및 모니터렝이 사용되는 방식으로 데이터 모델 스키마, 리니지, 필드 매핑, 파이프라인 등 포함
              - 운영: 프로세스, 로그, 성공 실패여부들을 모니터링
              - 참조: 내부코드, 지리코드 등 데이터를 분류할 때 필요한 데이터
          - 데이터의 접근이 안정성 있고 빨라야 함
          - 데이터와의 관계
        - 데이터 책임
          - 관료적이여 보일 수 있지만 데이터를 담당하는 인원이 있어야 함
        - 데이터 품질
          - 정확도: 중복, 수치 정확
          - 완전성: 기록, 유효값
            - 오프라인 때 발생하는 데이터에 대한 비용을 어떻게 부과할 것인가? 균일한 정책을 정해야 함
          - 적시성
    - 데이터 모델링 및 설계
      - 데이터 원천과 사용 사례에 적절한 수준과 유형의 모델링을 적용할 수 있는 모델링이 필요
    - 데이터 계보
      - 업스트림 데이터를 모두 추적하여 데이터의 감사 추적을 기록하는 것
      - 개발, 테스트 및 최종 생산 과정에 적용되어 기대에 부응하는 품질과 적합성을 제공
    - 저장 및 운영
    - 데이터 통합 및 상호 운용성
      - 다양한 도구가 쓰이므로 데이터를 통합 해야 함
    - 데이터 수명 주기 관리
      - 관리해야하는 이유
        - 비용
        - 데이터 보존 컴플라이언스
    - ML
    - 윤리 및 개인정보
  - 데이터옵스
    - 아래 사항들을 충족해야 함
      - 신속한 혁신
      - 높은 데이터 품질과 낮은 오류율
      - 인력, 기술, 환경 전반에 걸친 협업
      - 명확한 측정
      - 모니터링 및 결과의 투명성
    - 하나씩 추가하면서 데이터옵스를 구축할 수 있음
      - 자동화
        - CI/CD
        - 메타데이터 무결성 확인
        - 데이터 품질 체크 
        - 변화 수용을 할 수 있는 데이터 자동화
        - **핵심은 워크로드를 줄이고 비즈니스에 제공하는 가치를 높일 수 있는 자동화를 지속해서 구현할려고 하는 것!!!!**
      - 관찰가능성과 모니터링
        - 데이터의 수집, 변환, 분석까지 모든 단계에서 식별가능할 수 있도록 하며 데이터 문제를 해결하거나 예방하는 것
      - 사고대응
        - 모든 것은 항상 망가진다 라는 말처럼 항상 재해에 대비하고 가능한 한 신속하고 효율적으로 대응할 준비!
      - 데이터옵스의 우선순위를 높일 것
  - 데이터 아키텍처
    - 기술과 비즈니스간의 트레이드 오프를 파악하여 데이터 아키텍처를 구성해야 함
  - 오케스트레이션
    - 스케줄러
    - DAG형태로 작업 종속성에 따라 메타데이터 구축
    - 작업 기록이나 시각화 및 경고 기능 구축
    - backfill작업도 수행하고 디펜던시 작업도 지원
    - 에어플로우가 표준이 되가고 있음
  - 스프트웨어 엔지니어링
    - 추상화가 중요해짐
      - 공통 데이터 처리 코드
      - 오픈 소스 프레임워크 개발
      - 스트리밍
      - IaC