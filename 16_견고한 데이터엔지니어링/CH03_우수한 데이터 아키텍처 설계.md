# CH04 우수한 데이터 아키텍처 설계

---

## 데이터 아키텍처 정의

---

- 엔터프라이즈의 정의
  - 기업의 변화를 지원하는 시스템 설계로, 신중한 트레이드오프 평가를 통해 도달한 유연하고 되돌릴 수 있는 의사결정으로 달성됨
  - 기술적 솔루션은 그 자체를 위한 것이 아니라 비즈니스 목표를 지원하기 위해 존재한다
  - 현재 문제를 식별하고 바람직한 미래 상태를 정의하며 구체적인 단계를 통해 수행. 그 과정에서 물리적, 비용적, 실질적 트레이드오프는 필수불가결
  - **유연성과 트레이드오프 균형을 유지하는 것**
- 데이터 아키텍처 정의
  - 기업의 진화하는 데이터 요구 사항을 지원하는 시스템 설계로, 트레이드 오프에 대한 신중한 평가를 통해 유연하고 되돌릴 수 있는 결정을 내림으로써 실현

## 우수한 데이터 아키텍처

---
  
- 유연하고 유지관리 쉬움
- 원칙
  - 공통 컴포넌트를 현명하게 선택하라
    - 객체 스토리지, 버전 제어 시스템, 관찰 가능성, 모니터링 및 오케스트레이션, 처리엔진 등이 포함
    - 다시 개발하기 보단 이미 사용중인 것에 의존하는 것이 좋음
  - 장애에 대비
    - 가용성, 신뢰성, RTO(복구시간목표), RPO(복구시점목표)
  - 확장성을 위한 아키텍처
    - 스케일 업 + 스케일 다운을 탄력적으로 운영
  - 아키텍처는 리더십
    - 기술 리더십의 개념으로 더 복잡한 문제를 해결할 수 있또록 수준을 높여주고 개발 팀을 멘토링하고 아키텍트가 의사결정권자가 되어 병목 현상을 해결
  - 아키텍처에 충실하라
    - 기본 아키텍처의 깊은 지식을 개발하고 목표 아키텍처를 개발하며, 변경의 우선순위와 순서를 결정하며 시퀀싱 계획을 수립하는 것
  - 느슨하게 결합된 시스템 구축
    - 속성
      - 시스템은 많은 수의 작은 컴포넌트로 나뉨
      - **메시징 버스나 API와 같은 추상화 계층을 통해 다른 서비스와 상호 작용함**
      - 시스템 컴포넌트 내부 변경이 외부에 영향을 끼치지 않음
      - 배포 주기가 따로 없이 개별적으로 업데이트 진행
  - 되돌릴 수 있는 의사결정
    - 양방향 문으로 아키텍처를 단순화하고 민첩성 유지하려면 돌아갈 수 있어야 함
  - 보안 우선순위 지정
    - 외부 위협과 내부 위협을 다 고려하여 아키텍처를 설계해야 함
    - 클라우드에서 공통적인 부분은 보안을 해결하지만 어플리케이션 및 데이터에 대한 보안은 사용자가 책임져야 함
  - 핀옵스
    - 인프라의 지출을 데이터 중심으로 곤리하는 동시에 비용효율성을 높이고 궁극적으로는 클라우드 환경의 수익성을 높인다.
    - 자본 지출에서 종량제 방식으로 바뀜

## 주요 아키텍처 개념

---

- 도멘인과 서비스에 무엇을 할지
- 분산 시스템, 확장성, 장애에 대비한 설계
  - 확장성
  - 탄력성
  - 가용성
  - 신뢰성
- 강한 결합 vs 느슨한 결합
  - 단일계층
    - 데이터베이스와 어플리케이션이 단일서버에 상주
  - 다중 계층
    - `데이터 - 어플리케이션 - 프레젠테이션` 3티어 구조
    - 비공유 아키텍처로 단일노드가 리소스 공유 없이 격리된 환경에서 진행
    - 공유 디스크 아키텍처로 모든 노드에서 데이터를 공유할 때 사용
- 마이크로서비스
  - 뒤얽힌 서비스, 중앙 집중화, 서비스 간의 강한 결합과 같은 모놀리스 속성과 정반대
  - 개별적이고 분산되어 있으며 결합된 서비스
  - 데이터 아키텍처 내에서 사용하는 **데이터 기술의 상태와 한계를 인식하면서 이상적인 느슨한 결합을 실용적으로 사용할 것을 권장**함
- 사용자 접근: 싱글 vs 멀티테넌트
  - 성능과 보안이라는 두가지 요소를 고려하며 아키텍처 구성
- 이벤트 기반 아키텍처
  - 생산자 - 이벤트 라우터 - 소비자
  - 이벤트를 여러 서비스에 분산 시킬 수 있음
- 브라운필드 vs 그린필드 프로젝트
  - 브라운필드
    - 레거시 아키텍처를 천천히 접근하여 점진적 대체
  - 그린필드
    - 새롭게 출발하는 것도 좋지만 **작업 요건을 우선시**

## 데이터 아키텍처 사례 및 유형

---

- 데이터 웨어하우스
  - 조직 데이터 웨어하우스 아키텍처
    - OLTP와 OLAP를 분리: 운영 시스템의 부하가 줄어들고 분석 성능이 향상
    - 데이터 중앙 집중화 및 구성
  - 기술 데이터 웨어하우스 아키텍처
    - MPP 기반
- 클라우드 DW
  - DW도 스토리지를 분리하여 무한정의 스토리지와 빠른 조회 성능으로 DL과 DW간의 경계가 모호해지는중
- 데이터 마트
  - 분석과와 보고서 개발자가 데이터에 더 쉽게 접근
  - 초기 ETL, ELT 파이프라인이 제공하는 것보다 더 많은 변환 단계를 제공
- 데이터 레이크
  - HDFS에서 시작
  - 모든 크기와 다양한 유형의 방대한 데이터 저장 가능
  - mr, spark, ray, hive등 다양한 데이터 처리 기술을 선택해 작업을 수행할 수 있음
  - 스키마 관리, 데이터 카탈로그 검색 등이 없으면 실패함
- 데이터 플랫폼(차세대 데이터 레이크)
  - 데이터 레이크 하우스
    - 제어, 데이터 관리, 데이터 구조를 통합하는 동시에 객체 스토리지에 데이터를 저장하고 다양한 쿼리 및 변형 엔진을 지원
    - ACID 트랜잭션 지원
    - 데이터 레이크와 웨어하우스의 융합을 의미함
  - 다양한 벤더사가 데이터 플랫폼 제품들을 출시함
- 모던 데이터 스택
  - PnP 방식으로 복잡성을 줄이고 모듈화를 늘리는 것
  - 데이터 파이프라인, 스토리지, 변환, 관리/거버넌스, 모니터링, 시각화 및 탐색이 포함
- 람다 아키텍처
  - 배치, 스트리밍, 서빙 계층이 독립적으로 작동
- 카파 아키텍처
  - 스트림 처리 플랫폼을 데이터 처리, 저장 및 서빙등 모든 데이터 처리의 백본으로 사용
  - 스트리밍이 미지의 영역이고 복잡하고 비용이 많이들어 많이 도입되지는 못함
- 데이터 흐름 모델, 통합 배치, 스트리밍
  - 모든 데이터를 이벤트로 간주
  - 실시간 처리와 배치 처리를 통합하여 처리할 수 있도록 나아가는중
- IoT용 아키텍처
  - 각 사물로 부터 데이터를 수집하고 에지 컴퓨팅/머신러닝을 수행할 수도 있음
  - 인터페이스
    - IoT 게이트웨이: 장치를 연결하고 인터넷에 라우팅하는 허브
    - 수집: 오프라인 환경에서도 데이터가 발생할 수 있는 환경의 다양성 때문에 분석에서 고려해야 할 다양한 문제가 있음
    - 스토리지: 메시지큐나 시계열DB로 실시간에 가까운 응답이 가능한 스토리지 사용
    - 서빙: 알람, 보고서 제공, 머신러닝 등 다양함
- 데이터 매시
  - 탈중앙화
  - 핵심 구성 요소
    - 도메인 지향 분산형 데이터 소유권 및 아키텍처
    - 제품으로서 데이터
    - 플랫폼으로서 셀프서비스 데이터 인프라
    - 통합 컴퓨팅 거버넌스
- 기타 아키텍처: 데이터 페브릭, 확장 아키텍처, 이벤트 기반 아키텍처 등

## 아키텍처 설계 담당자는 누구인가?

---

- 아키텍처와 엔지니어링의 분리가 줄어드는 상황
- 트레이드오프를 고려해야 함
  - DW vs DL
  - 통합 배치 및 스트리밍 프레임워크

## 결론

---

- **내재된 트레이드 오프를 이해하고 깊이 연구하고 조직의 고유한 요구 사항에 대응하는 아키텍처를 설계할 것**
  - 데이터 아키텍처가 수명 주기에 어떻게 부합하는지
  - 우수한 데이터 아키텍처를 만드는 요소가 무엇인지
  - 데이터 아키텍처의 예시
